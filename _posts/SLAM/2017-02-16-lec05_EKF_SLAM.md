---
layout: post
title: '[SLAM] Extended Kalman Filter(EKF) SLAM'
tags: [SLAM]
description: >
  실제 EKF를 SLAM에 어떻게 적용시키는지에 대해서 설명한다.

sitemap :
  changefreq : weekly
  priority : 1.0
---

**본 글은 University Freiburg의 [Robot Mapping](http://ais.informatik.uni-freiburg.de/teaching/ws13/mapping/) 강의를 바탕으로 이해하기 쉽도록 정리하려는 목적으로 작성되었습니다. 개인적인 의견을 포함하여 작성되기 때문에 틀린 내용이 있을 수도 있습니다. 틀린 부분은 지적해주시면 확인 후 수정하겠습니다.**

SLAM(Simultaneous Localization and Mapping) 문제를 풀기위한 방법은 크게 3개로 나눌 수 있다.

* Kalman Filter
* Particle Filter
* Graph-based

이 글에서는 첫번째 방법인 Kalman filter를 이용한 방법에 대해서 설명한다.

### EKF for online SLAM

<img align="middle" src="/images/post/SLAM/lec05_EKF_SLAM/onlie_slam.png" width="100%">

위 그림은 EKF를 이용한 online SLAM을 표현하였다. online이라는 이름은 로봇의 이전 위치는 저장하지 않고, 현재의 위치만 추정하기 때문에 붙은 이름이다. $$\mathbf{x_t}$$는 로봇의 위치, $$\mathbf{m}$$은 landmark를 의미하며, $$z$$와 $$u$$는 각각 observation과 control input이다. 이 문제를 식으로 표현하면 다음과 같다.

$$
p(\mathbf{x_t}, \mathbf{m} \mid \mathbf{z}_{1:t}, \mathbf{u}_{1:t})
$$

즉, 처음부터 현재시간 t까지의 control input과 센서로부터 얻은 observation을 알고 있을 때 현재 로봇의 위치인 $$\mathbf{x_t}$$와 맵을 구성하는 landmark인 $$\mathbf{m}$$를 구하는 문제이다.

#### state 표현방법

우선 설명의 시작에 앞서 로봇이 이동하는 공간은 2D로 한정한다. 즉 로봇의 위치는 x좌표와 y좌표, 그리고 로봇의 방향(heading)으로 정의된다. 또한 landmark는 방향 없이 x,y좌표로 정의된다. 이 설명에서는 센서로부터 얻어진 lanemark의 정보가 map상의 어떤 landmark인지는 알고 있다는 가정을 한다. 왜냐하면 센서정보를 이용하여 landmark의 correspondence를 찾는 것 또한 하나의 연구 분야이기 때문이다. 위의 식  $$p(\mathbf{x_t}, \mathbf{m} \mid \mathbf{z}_{1:t}, \mathbf{u}_{1:t})$$에서 알 수 있듯이, control input과 observation을 이용하여 우리가 추정하고자 하는 것은 로봇의 위치와 landmark의 위치이다. 따라서 EKF SLAM에서는 다음과 같이 이 두 정보를 하나의 state vector로 정의한다.

$$
\mathbf{x}_t = (x, y, \theta, m_{1,x},m_{1,y}, m_{2,x},m_{2,y},\cdots, m_{n,x},m_{n,y})
$$

vetor($$\mathbf{x}_t$$)의 앞의 3개항($$x,y,\theta$$)는 로봇의 x,y위치와 heading의 방향을 의미하며, 나머지 항은 landmark의 위치의 x,y좌표이다. 만약 landmark의 갯수가 n개 일 때 $$\mathbf{x}_t$$ vector의 크기는 $$3+2n$$이다. 이렇게 state vector가 정의되었을 때 Covariance matrix는 다음 그림과 같이 정의된다.

<img align="middle" src="/images/post/SLAM/lec05_EKF_SLAM/representation1.png" width="100%">
<img align="middle" src="/images/post/SLAM/lec05_EKF_SLAM/representation2.png" width="100%">
<img align="middle" src="/images/post/SLAM/lec05_EKF_SLAM/representation3.png" width="100%">




**본 글을 참조하실 때에는 출처 명시 부탁드립니다.**
